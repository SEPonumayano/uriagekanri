<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
<link rel="stylesheet" th:href="@{/css/NewFile.css}"/>
<meta charset="UTF-8">
<title>一覧</title>
</head>
<body>
<p>製造部売上管理システム：案件一覧</p>
<!-- 登録ボタン -->
	<div class="menu">
	<div class="add">
		<a th:href="@{/add}"><button type="button" style="width:200px">新規登録</button></a>
	</div>
		<!-- 住所検索 -->
	<div class="serch">
	<form class="seach" th:action="@{/{key}/list(key=keyword)}" th:object="${DataRequest}" th:method="post">
	<div class="seachsubTitle">件名：</div>
	<div class="seachsubTitle"><input class="seachword" type="text" name="keyword" th:value="${keyword}" style="width:200px">
	<input class="sss" type=submit value="検索" style="width:204px">
	</div>
	</form>
	</div>
	</div>
<br/>
<!-- 顧客選択 -->
<div class="pulldownset">
<select class="clientste">
<option></option>
<option th:each="clientname: ${clientdd}" th:value="${clientname.nameid}" th:text="${clientname.client}">
</option>
</select>
<!-- ステータス -->
<select id="1" class="clientstes">
<option></option>
<option th:each="ste1: ${ste1}" th:value="${ste1.statusid}" th:text="${ste1.stname}">
</option>
</select>
<select id="2" class="clientstes">
<option></option>
<option th:each="ste2: ${ste2}" th:value="${ste2.statusid}" th:text="${ste2.stname}"></option>
</select>
<select id="3" class="clientstes">
<option></option>
<option th:each="ste3: ${ste3}" th:value="${ste3.statusid}" th:text="${ste3.stname}"></option>
</select>
</div>
<script type="text/javascript">
//HTMLの読み込み直後に実行
document.addEventListener('DOMContentLoaded', function() {

	//ステータス非表示にする
	   var allSubBoxes = document.getElementsByClassName("clientstes");
	   for( var i=0 ; i<allSubBoxes.length ; i++) {
	      allSubBoxes[i].style.display = 'none';
	   }

   //顧客名ごとにステータスを切り替え
   var mainBoxes = document.getElementsByClassName('pulldownset');
   for( var i=0 ; i<mainBoxes.length ; i++) {

      var clientste = mainBoxes[i].getElementsByClassName("clientste");
      clientste[0].onchange = function () {

         var subBox = this.parentNode.getElementsByClassName("clientstes");
         for( var j=0 ; j<subBox.length ; j++) {
            subBox[j].style.display = 'none';
         }

         //指定されたステータスの表示
         if( this.value ) {
            var targetSub = document.getElementById( this.value );
            targetSub.style.display = 'inline';
         }
      }

   }

});
</script>
<br/>
<!-- ページング -->

	<div th:fragment='paginationbar'>
	<ul>
	<li th:class="${page.firstPage}?'disabled':''" style="display:inline">
    <span th:if='${page.firstPage}'>＜＜</span>
    <a th:if='${not page.firstPage}' th:href='@{${page.url}(keyword=${keyword},page=0,size=${page.size})}'>＜＜</a>
    </li>
	<li th:class="${page.hasPreviousPage}? '' :'disabled'" style="display:inline">
	<span th:if='${not page.hasPreviousPage}'>＜</span>
	<a th:if='${page.hasPreviousPage}' th:href='@{${page.url}(keyword=${keyword},page=${page.number-2},size=${page.size})}'>＜</a>
	</li>
	<li th:each='item : ${page.items}' th:class="${item.current}? 'active' : ''" style="display:inline">
	<span th:if='${item.current}' th:text='${item.number}'>1</span>
	<a th:if='${not item.current}' th:href='@{${page.url}(keyword=${keyword},page=${item.number-1},size=${page.size})}'>
    <span th:text='${item.number}'>1</span>
    </a>
	</li>
	<li th:class="${page.hasNextPage}? '' : 'disabled'" style="display:inline">
    <span th:if='${not page.hasNextPage}'>＞</span>
    <a th:if='${page.hasNextPage}' th:href='@{${page.url}(keyword=${keyword},page=${page.number},size=${page.size})}'>＞</a>
    </li>
    <li th:class="${page.lastPage}? 'disabled' : ''" style="display:inline">
    <span th:if='${page.lastPage}'>＞＞</span>
    <a th:if='${not page.lastPage}' th:href='@{${page.url}(keyword=${keyword},page=${page.totalPages - 1},size=${page.size})}'>＞＞</a>
    </li>
	</ul></div>

<table border="1">
<tr>
<th>No</th>
<th>顧客名</th>
<th>受注日</th>
<th>S番号</th>
<th>件名</th>
<th>数量</th>
<th>納入指定日/納入日</th>
<th>請求日</th>
<th>見積金額/受注金額</th>
<th>ステータス</th>
<th></th>
<th></th>
</tr>
<tr th:each="datalist,nameStat:${test}" th:object="${datalist3}">
<td th:text="${nameStat.count}+${page.size}*(${page.number}-1)"></td>
<td th:text="${datalist.client}"></td>
<td th:text="${datalist.orderdate}"></td>
<!--  <td th:text="${datalist.snumber}"></td>--><td th:text="${datalist.snumber}"></td>
<td th:text="${datalist.subtitle}"></td>
<td th:text="${datalist.items}"></td>
<td th:text="${datalist.deliveryDesignatedDate}+'/'+${datalist.deliveryDate}"></td>
<td th:text="${datalist.billingDate}"></td>
<td th:text="${datalist.estimatedAmount}+'/'+${datalist.order_amount}"></td>
<td th:text="${datalist.stname}"></td>
<td>
<form th:action="@{/{id}/edit(id=${datalist.id})}" th:method="post">
<input type="hidden" name="id" th:value="${datalist.id}">
<input type="hidden" name="client" th:value="${datalist.client}">
<input type="submit" value="編集">
</form>
</td>
<td>
<form th:action="@{/{id}/delete(id=${datalist.id})}" th:method="post">
<input type="hidden" name="id" th:value="${datalist.id}">
<input type="hidden" name="client" th:value="${datalist.client}">
<input type="submit" value="削除"></form>
</td>
</tr>
</table>


<!-- ページング -->

	<div th:fragment='paginationbar'>
	<ul>
	<li th:class="${page.firstPage}?'disabled':''" style="display:inline">
    <span th:if='${page.firstPage}'>＜＜</span>
    <a th:if='${not page.firstPage}' th:href='@{${page.url}(keyword=${keyword},page=0,size=${page.size})}'>＜＜</a>
    </li>
	<li th:class="${page.hasPreviousPage}? '' :'disabled'" style="display:inline">
	<span th:if='${not page.hasPreviousPage}'>＜</span>
	<a th:if='${page.hasPreviousPage}' th:href='@{${page.url}(keyword=${keyword},page=${page.number-2},size=${page.size})}'>＜</a>
	</li>
	<li th:each='item : ${page.items}' th:class="${item.current}? 'active' : ''" style="display:inline">
	<span th:if='${item.current}' th:text='${item.number}'>1</span>
	<a th:if='${not item.current}' th:href='@{${page.url}(keyword=${keyword},page=${item.number-1},size=${page.size})}'>
    <span th:text='${item.number}'>1</span>
    </a>
	</li>
	<li th:class="${page.hasNextPage}? '' : 'disabled'" style="display:inline">
    <span th:if='${not page.hasNextPage}'>＞</span>
    <a th:if='${page.hasNextPage}' th:href='@{${page.url}(keyword=${keyword},page=${page.number},size=${page.size})}'>＞</a>
    </li>
    <li th:class="${page.lastPage}? 'disabled' : ''" style="display:inline">
    <span th:if='${page.lastPage}'>＞＞</span>
    <a th:if='${not page.lastPage}' th:href='@{${page.url}(keyword=${keyword},page=${page.totalPages - 1},size=${page.size})}'>＞＞</a>
    </li>
	</ul></div>

<!-- 登録ボタン -->
	<div class="menu">
	<div class="add">
		<a th:href="@{/add}"><button type="button" style="width:200px">新規登録</button></a>
	</div>
	</div>
</body>
</html>